<!DOCTYPE html>
<html>

<head>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-941797-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());

      gtag('config', 'UA-941797-10');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Learning Locker Documentation</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Documentation for Learning Locker, the open source learning record store.">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/tomorrow-night.css">
    <link rel="stylesheet" href="../css/docs.css">

    <script type="text/javascript">
        function prettyCode() {
            var tables = document.getElementsByTagName('table');
            for (index = 0; index < tables.length; ++index) {
                tables[index].className = "table table-default table-bordered";
            }
        }
    </script>
</head>


<body onload="prettyCode();">

  <div class="docs-masthead">
    <div class="container">
      <a href="../welcome"><img src="../images/logo-small.png" class="logo"></a>
        <nav class="docs-nav pull-right">
            <a class="docs-nav-item" href="http://learninglocker.net">Main Website</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/learninglocker">Github</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/docs">Edit</a>
        </nav>
    </div>
</div>


  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-3 docs-sidebar">
        <div class="sidebar-title">
          <a href="../welcome">Overview</a>
        </div>
        <ul class="nav">
          <li><a href="../overview-architecture">Architecture</a></li>
          <li><a href="../overview-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="#">Guides</a>
        </div>
        <ul class="nav">
          <li><a href="../guides-installing">Installation</a></li>
          <li><a href="../guides-custom-installation">Custom Installations</a></li>
          <li><a href="../guides-configuring">Configuration</a></li>
          <li><a href="../guides-cli">CLI Operations</a></li>
          <li><a href="../guides-migrating">Migrating from v1</a></li>
          <li><a href="../guides-indexing">Indexing</a></li>
          <li><a href="../guides-monitoring">Monitoring</a></li>
          <li><a href="../guides-structuring">Structuring your LRS</a></li>
          <li><a href="../guides-inserting">Inserting statements</a></li>
          <li><a href="../guides-retrieving">Retrieving statements</a></li>
          <li><a href="../guides-integrating">Integrations</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">HTTP Interfaces (APIs)</a>
        </div>
        <ul class="nav">
          <li><a href="../http-rest">REST API</a></li>
          <li><a href="../http-connection">Connection API</a></li>
          <li><a href="../http-aggregation">Aggregation API</a></li>
          <li><a href="../http-aggregate"><strong>[Enterprise]</strong> Aggregate API</a></li>
          <li><a href="../http-statement-deletion">Statement Deletion API</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">Models</a>
        </div>
        <ul class="nav">
          <li><a href="../http-activities"><strong>[Enterprise]</strong> Activities</a></li>
          <li><a href="../http-clients">Clients</a></li>
          <li><a href="../http-dashboards">Dashboards</a></li>
          <li><a href="../http-downloads">Downloads</a></li>
          <li><a href="../http-exports">Exports</a></li>
          <li><a href="../http-journeys"><strong>[Enterprise]</strong> Journeys</a></li>
          <li><a href="../http-journey-progress"><strong>[Enterprise]</strong> Journey Progress</a></li>
          <li><a href="../http-organisations">Organisations</a></li>
          <li><a href="../http-personas">Personas</a></li>
          <li><a href="../http-persona-identifiers">Persona Identifiers</a></li>
          <li><a href="../http-persona-attributes">Persona Attributes</a></li>
          <li><a href="../http-persona-imports">Persona Imports</a></li>
          <li><a href="../http-queries">Queries</a></li>

          <li><a href="../http-roles">Roles</a></li>
          <li><a href="../http-statements">Statements</a></li>
          <li><a href="../http-statement-forwarding">Statement Forwarding</a></li>
          <li><a href="../http-stores">Stores</a></li>
          <li><a href="../http-users">Users</a></li>
          <li><a href="../http-visualisations">Visualisations</a></li>
          <li><a href="../http-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="../faqs">FAQs</a>
        </div>
      </div>
      <div class="col-xs-12 col-sm-9 docs-main">
        <h1 id="inserting-statements-guide">Inserting Statements Guide</h1>
<p>To quickly try out inserting statements into your Learning Locker instance you can use Postman. Postman is a tool for creating and sending HTTP requests. You can <a href="https://www.getpostman.com/">download and install Postman via their website</a>. Once you’ve installed Postman, you can check out the <a href="../http-xapi-statements">documentation for our xAPI HTTP Interface</a>.</p>

<p>Before you start designing and inserting your own statements in production, you should consider using <a href="../guides-integrating/#existing-integrations">tools that already transmit xAPI statements</a>. If you can’t use any of these existing tools, there are a number of processes and best practices that you can follow to fall into the pit of success when designing and transmitting your own statements.</p>

<ul>
  <li>Design Statements
    <ol>
      <li><a href="#list-experiences">List the experiences</a> you wish to capture for analysis.</li>
      <li><a href="#create-recipes">Create a recipe</a> (a statement template for an experience) for each experience from the previous step.</li>
      <li><a href="#map-variables">Map the variables</a> in each recipe to variables in your application.</li>
    </ol>
  </li>
  <li>Transmit Statements
    <ol>
      <li><a href="#identify-sources">Identify the sources</a> that will construct and transmit statements.</li>
      <li><a href="#implementing-transmission">Implement the transmission</a> from the sources to the LRS.</li>
    </ol>
  </li>
</ul>

<h2 id="list-experiences">List Experiences</h2>
<p>At this stage you should figure out which experiences are important to track (e.g. logging in, completing a quiz, watching a video, etc.) and what data you ideally need to capture for analysis (e.g. quiz score, video duration, etc.). When creating this list, you may wish to consider the data required to:</p>

<ul>
  <li>Answer your research questions.</li>
  <li>Produce your stakeholder reports.</li>
  <li>Adapt and improve the experiences of your users.</li>
</ul>

<h2 id="create-recipes">Create Recipes</h2>
<p>At this stage you should create some example statements for each of the experiences you listed earlier ensuring that you include all of the data required for each experience inside the statement.</p>

<p>Before you create a recipe, consider reusing one of the <a href="https://registry.tincanapi.com/#home/profiles">recipes in the Tin Can Registry</a> as this will hopefully save you some time, improve your compatibility with existing systems, and ensure that you’re using best practices. You may need to adapt these existing recipes to better meet your needs, as you may require additional data or not require some of the data they specify.</p>

<p>If you can’t find an existing recipe, don’t worry, it’s easy to create your own and we have some guidelines below.</p>

<ul>
  <li>Your actors should be identified by an <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#2424-account-object">account</a>, where the <code class="language-plaintext highlighter-rouge">homePage</code> is an IRI for the application and the <code class="language-plaintext highlighter-rouge">name</code> is an identifier for the user. Other identifier types are available, but we recommend using an account.</li>
  <li>Try to select an appropriate <a href="https://registry.tincanapi.com/#home/verbs">verb from the Tin Can Registry</a> before creating your own.</li>
  <li>Try to select an appropriate <a href="https://registry.tincanapi.com/#home/activityTypes">activity type from the Tin Can Registry</a> before creating your own.</li>
  <li>Only include one language in your languages maps. Preferably this should use the language of the user.</li>
  <li>You should set a <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#timestamp">timestamp</a> with the correct time zone, otherwise the LRS will generate one that uses the time the statement was stored instead of the time an experience occurred, which is inaccurate for analysis.</li>
  <li>Your verb and object identifiers should preferably resolve to a JSON representation of the verb or object.</li>
  <li>The <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#context">statement context</a> should contain some minimal debugging information in the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#miscext">extensions</a>. For example, you might define the version of your statement transmission tool and platform.</li>
</ul>

<p>A statement for “viewing an application” using these guidelines might look a bit like the statement below.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"actor"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example User"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"account"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"homePage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.example.org"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_user_id"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"verb"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://id.tincanapi.com/verb/viewed"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"display"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"en"</span><span class="p">:</span><span class="w"> </span><span class="s2">"viewed"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"object"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.example.org"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"definition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://activitystrea.ms/schema/1.0/application"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"en"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Application"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"context"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"platform"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Platform"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"extensions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"http://www.example.org/transition_tool_version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2015-01-01T01:00Z"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>There are <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Data.md#appendix-a-example-statements">more example statements provided in the xAPI specification</a>. For further support and consultation, you can email <a href="mailto:hello@learninglocker.net">hello@learninglocker.net</a>.</p>

<h2 id="map-variables">Map Variables</h2>
<p>Using the recipes from the previous step, you should map the data required in each of the recipes to variables in your application. You might find it useful to use a table like the one below.</p>

<table>
  <thead>
    <tr>
      <th>Statement Property</th>
      <th>Mapping</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">actor.name</code></td>
      <td>User’s full name from our user data model.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">actor.account.homePage</code></td>
      <td>The URL of the application: “http://www.example.org”</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">actor.account.name</code></td>
      <td>User’s identifier from our user data model.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">object.id</code></td>
      <td>The URL of the application: “http://www.example.org”</td>
    </tr>
    <tr>
      <td>…</td>
      <td>…</td>
    </tr>
  </tbody>
</table>

<h2 id="identify-sources">Identify Sources</h2>
<p>At this stage, you should identify where the statement will be constructed and transmitted for each recipe that you identified earlier.</p>

<p>You should consider whether you will be sending statements from the <a href="https://en.wikipedia.org/wiki/Client-side">client-side</a> or the <a href="https://en.wikipedia.org/wiki/Server-side">server-side</a> for each recipe as this will affect the transmission implementation. Alternatively, you may be creating statements using an external service, so at this stage you may also wish to consider whether you will need to <a href="https://en.wikipedia.org/wiki/Polling_(computer_science)">poll</a> that service for events or whether you can use <a href="https://en.wikipedia.org/wiki/Webhook">webhooks</a> or an <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">event listener</a> (with something like <a href="https://redis.io/topics/pubsub">Redis</a>).</p>

<h2 id="implementing-transmission">Implementing Transmission</h2>
<p>At this stage, you can start planning and implementing the transmission of statements to your Learning Locker instance via the <a href="../http-xapi-statements">xAPI HTTP Interface</a>. However, there are a number of things listed below that you should consider before you begin.</p>

<ul>
  <li><a href="#batching-statements">Batching Statements</a></li>
  <li><a href="#handling-sending-failures">Handling Sending Failures</a></li>
  <li><a href="#sending-securely">Sending Securely</a></li>
</ul>

<h3 id="batching-statements">Batching Statements</h3>
<p>If you’re potentially sending a significant number of statements in a short period of time, you should consider sending statements to the LRS in batches to improve response times, reduce HTTP requests, and reduce the elapsed time spent sending statements. For example, on the server-side this may be implemented with the use of a statement log and a cron job (the <a href="https://github.com/xAPI-vle/moodle-logstore_xapi/pull/26">Moodle Logstore plugin</a> is an example of this).</p>

<h3 id="handling-sending-failures">Handling Sending Failures</h3>
<p>If a statement fails to be sent you may want to consider implementing some retry strategies to resend statements that previously failed to be stored (normally because of downtime). We’d recommend that you send these failed statements in <a href="#batching-statements">batches</a>. If you’re sending statements from the client-side, we’d recommend that you wait 5-60 seconds between retries and retry a maximum of 3-5 times. If you’re sending statements server-side, you may want to consider storing failed statements somewhere and using a Cron job to send them.</p>

<h3 id="sending-securely">Sending Securely</h3>
<p>If you’re sending statements from the server-side this shouldn’t be an issue as the LRS credentials are not exposed. However, if you’re sending statements from the client-side, you should consider finding a way to protect the LRS credentials so that they’re not exposed to tech-savvy users, since a malicious user may try to read sensitive data from, or write unwanted data to, the LRS. We’d recommend using the <a href="https://github.com/adlnet/xapi-launch">xAPI launch process</a> with Learning Locker’s Launchr, you can email <a href="mailto:hello@learninglocker.net">hello@learninglocker.net</a> for more information about this.</p>

      </div>
    </div>
  </div>

  <footer class="docs-footer">
  <p>Learning Locker and the Squirrel logo are trademark of Learning Pool
    <script>document.write(new Date().getFullYear())</script> | Learning Locker is licensed under GPL 3.0.</p>
  <p>
    <a href="#">Back to top</a>
  </p>
</footer>


</body>

</html>