<!DOCTYPE html>
<html>

<head>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-941797-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());

      gtag('config', 'UA-941797-10');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Learning Locker Documentation</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Documentation for Learning Locker, the open source learning record store.">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/tomorrow-night.css">
    <link rel="stylesheet" href="../css/docs.css">

    <script type="text/javascript">
        function prettyCode() {
            var tables = document.getElementsByTagName('table');
            for (index = 0; index < tables.length; ++index) {
                tables[index].className = "table table-default table-bordered";
            }
        }
    </script>
</head>


<body onload="prettyCode();">

  <div class="docs-masthead">
    <div class="container">
      <a href="../welcome"><img src="../images/logo-small.png" class="logo"></a>
        <nav class="docs-nav pull-right">
            <a class="docs-nav-item" href="http://learninglocker.net">Main Website</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/learninglocker">Github</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/docs">Edit</a>
        </nav>
    </div>
</div>


  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-3 docs-sidebar">
        <div class="sidebar-title">
          <a href="../welcome">Overview</a>
        </div>
        <ul class="nav">
          <li><a href="../overview-architecture">Architecture</a></li>
          <li><a href="../overview-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="#">Guides</a>
        </div>
        <ul class="nav">
          <li><a href="../guides-installing">Installation</a></li>
          <li><a href="../guides-custom-installation">Custom Installations</a></li>
          <li><a href="../guides-configuring">Configuration</a></li>
          <li><a href="../guides-cli">CLI Operations</a></li>
          <li><a href="../guides-migrating">Migrating from v1</a></li>
          <li><a href="../guides-indexing">Indexing</a></li>
          <li><a href="../guides-monitoring">Monitoring</a></li>
          <li><a href="../guides-structuring">Structuring your LRS</a></li>
          <li><a href="../guides-inserting">Inserting statements</a></li>
          <li><a href="../guides-retrieving">Retrieving statements</a></li>
          <li><a href="../guides-integrating">Integrations</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">HTTP Interfaces (APIs)</a>
        </div>
        <ul class="nav">
          <li><a href="../http-rest">REST API</a></li>
          <li><a href="../http-connection">Connection API</a></li>
          <li><a href="../http-aggregation">Aggregation API</a></li>
          <li><a href="../http-aggregate"><strong>[Enterprise]</strong> Aggregate API</a></li>
          <li><a href="../http-statement-deletion">Statement Deletion API</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">Models</a>
        </div>
        <ul class="nav">
          <li><a href="../http-activities"><strong>[Enterprise]</strong> Activities</a></li>
          <li><a href="../http-clients">Clients</a></li>
          <li><a href="../http-dashboards">Dashboards</a></li>
          <li><a href="../http-downloads">Downloads</a></li>
          <li><a href="../http-exports">Exports</a></li>
          <li><a href="../http-journeys"><strong>[Enterprise]</strong> Journeys</a></li>
          <li><a href="../http-journey-progress"><strong>[Enterprise]</strong> Journey Progress</a></li>
          <li><a href="../http-organisations">Organisations</a></li>
          <li><a href="../http-personas">Personas</a></li>
          <li><a href="../http-persona-identifiers">Persona Identifiers</a></li>
          <li><a href="../http-persona-attributes">Persona Attributes</a></li>
          <li><a href="../http-persona-imports">Persona Imports</a></li>
          <li><a href="../http-queries">Queries</a></li>

          <li><a href="../http-roles">Roles</a></li>
          <li><a href="../http-statements">Statements</a></li>
          <li><a href="../http-statement-forwarding">Statement Forwarding</a></li>
          <li><a href="../http-stores">Stores</a></li>
          <li><a href="../http-users">Users</a></li>
          <li><a href="../http-visualisations">Visualisations</a></li>
          <li><a href="../http-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="../faqs">FAQs</a>
        </div>
      </div>
      <div class="col-xs-12 col-sm-9 docs-main">
        <h1 id="xapi-activities-http-interface">xAPI Activities HTTP Interface</h1>
<p>The table below describes the routes that the HTTP interface provides, all of the URLs are relative to http://www.example.org/data/xAPI where http://www.example.org is the URL of your Learning Locker instance. To access this interface, you must additionally supply your Basic Auth details with each request in the <code class="language-plaintext highlighter-rouge">Authorization</code> header. Your Basic Auth details can be found under <strong>Settings</strong> &gt; <strong>Clients</strong>. Go to the <a href="../http-xapi">xAPI HTTP interface documentation</a> to see the rest of the xAPI routes.</p>

<table>
  <thead>
    <tr>
      <th>Route</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="../http-xapi-activities#get-activities">GET /activities</a></td>
      <td>Retrieves a fully described activity.</td>
    </tr>
    <tr>
      <td><a href="../http-xapi-activities#put-activitiesprofile">PUT /activities/profile</a></td>
      <td>Creates or overwrites a profile document.</td>
    </tr>
    <tr>
      <td><a href="../http-xapi-activities#post-activitiesprofile">POST /activities/profile</a></td>
      <td>Creates or merges a profile document.</td>
    </tr>
    <tr>
      <td><a href="../http-xapi-activities#get-activitiesprofile">GET /activities/profile</a></td>
      <td>Retrieves a single profile document or multiple profile identifiers.</td>
    </tr>
    <tr>
      <td><a href="../http-xapi-activities#delete-activitiesprofile">DELETE /activities/profile</a></td>
      <td>Deletes a single profile document.</td>
    </tr>
  </tbody>
</table>

<iframe src="https://player.vimeo.com/video/168961913" width="80%" height="360" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen="" style="padding-left: 15%;"></iframe>

<h2 id="get-activities">GET /activities</h2>
<p>This route allows you to retrieve the full definition of an activity, meaning that the LRS will return all of the languages displays and extensions that have been sent in statements, along with the most up to date <code class="language-plaintext highlighter-rouge">moreInfo</code> and <code class="language-plaintext highlighter-rouge">type</code> property values. This route requires an <code class="language-plaintext highlighter-rouge">activityId</code> URL parameter (an IRI representing the activity). To try this route out, first <a href="#insert-different-activity-definitions">insert two statements with different activity definitions</a> and then use the route to <a href="#retrieve-full-activity-definition">retrieve the full activity definition</a>. For more information, view the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Communication.md#25-activities-resource">GET /activities route in the xAPI specification</a>.</p>

<h3 id="insert-different-activity-definitions">Insert Different Activity Definitions</h3>
<p>To insert two statements with different activity definitions, use the <a href="../http-xapi-statements#post-statements">POST /statements route</a> like the request below, which will return a 200 response if the statements are successfully stored.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">POST http://www.example.org/data/xAPI/statements
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
Content-Type: application/json; charset=utf-8

[{
  "actor": { "mbox": "mailto:test@example.org" },
  "verb": { "id": "http://www.example.org/verb" },
  "object": {
    "id": "http://www.example.org/activity",
    "definition": {
      "name": {
        "en-GB": "GB Activity Name"
      },
      "description": {
        "en-GB": "GB Activity Description"
      },
      "extensions": {
        "http://www.example.com/extension/1": "extension_value_1"
      },
      "moreInfo": "http://www.example.org/activity/moreinfo1",
      "type": "http://www.example.org/activity/type1"
    }
  }
}, {
  "actor": { "mbox": "mailto:test@example.org" },
  "verb": { "id": "http://www.example.org/verb" },
  "object": {
    "id": "http://www.example.org/activity",
    "definition": {
      "name": {
        "en-US": "US Activity Name"
      },
      "description": {
        "en-US": "US Activity Description"
      },
      "extensions": {
        "http://www.example.com/extension/2": "extension_value_2"
      },
      "moreInfo": "http://www.example.org/activity/moreinfo2",
      "type": "http://www.example.org/activity/type2"
    }
  }
}]
</span></code></pre></div></div>

<h3 id="retrieve-full-activity-definition">Retrieve Full Activity Definition</h3>
<p>To retrieve the full activity definition, you can use a request similar to the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response will always be a 200 for valid requests, similar to the response below. Notice that the <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">description</code>, and <code class="language-plaintext highlighter-rouge">extensions</code> objects have been merged inside the <code class="language-plaintext highlighter-rouge">definition</code> object. Also notice that the <code class="language-plaintext highlighter-rouge">moreInfo</code> and <code class="language-plaintext highlighter-rouge">type</code> properties are set to the most recent values.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.example.org/activity"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"definition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"en-GB"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GB Activity Name"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"en-US"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US Activity Name"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"en-GB"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GB Activity Description"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"en-US"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US Activity Description"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"extensions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"http://www.example.com/extension/1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"extension_value_1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"http://www.example.com/extension/2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"extension_value_2"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"moreInfo"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.example.org/activity/moreinfo2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.example.org/activity/type2"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="put-activitiesprofile">PUT /activities/profile</h2>
<p>This route allows you to create a single profile document if it doesn’t exist or overwrite an existing profile document if it does exist. The route has 2 required URL parameters, an <code class="language-plaintext highlighter-rouge">activityId</code> (an IRI representing the activity) and a <code class="language-plaintext highlighter-rouge">profileId</code> (a string representing an identifier for the profile). For more information, view the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Communication.md#27-activity-profile-resource">PUT /activities/profile route in the xAPI specification</a>.</p>

<h3 id="put-initial-profile">PUT Initial Profile</h3>
<p>To PUT an initial profile, the request should be something like the request below. Notice that there is an <code class="language-plaintext highlighter-rouge">If-None-Match</code> header in the request below, this is to ensure that a profile document doesn’t already exist before the profile document is created. Without the <code class="language-plaintext highlighter-rouge">If-None-Match</code> header there would be a precondition failure thrown and the response would be a 412 for the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">PUT http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
Content-Type: application/json; charset=utf-8
If-None-Match: "*"

{
  "key_to_remove": "value_to_remove",
  "key_to_change": "value_before_changed"
}
</span></code></pre></div></div>

<p>This route returns a 204 response with no content when the profile document is successfully created, like the example response below. The route will return 412 for a precondition failure if the profile document does already exist and the profile document will not be changed.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">NO CONTENT</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
</code></pre></div></div>

<h3 id="get-initial-put-activity-etag">GET Initial PUT Activity ETag</h3>
<p>To retrieve the ETag for the initial profile, you need to retrieve the profile via the <a href="#get-activitiesprofile">GET /activities/profile route</a>. The request below demonstrates how to do this.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below. Notice that it contains the <code class="language-plaintext highlighter-rouge">ETag</code> header.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"7C0791125FAB08C7EB75CC8044CFDCEA56F506958DEEE763E6608608EE76C9EE"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:16:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"key_to_remove"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_to_remove"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"key_to_change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_before_changed"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="put-overwrite-profile">PUT Overwrite Profile</h3>
<p>To PUT a profile for overwriting, the request should be something like the request below. Notice that the <a href="#get-initial-put-activity-etag">ETag from the previous request</a> has been used in the <code class="language-plaintext highlighter-rouge">If-Match</code> header below. Without the <code class="language-plaintext highlighter-rouge">If-Match</code> header containing the correct ETag there would be a precondition failure thrown and the response would be a 412 for the request below. The <code class="language-plaintext highlighter-rouge">If-Match</code> header ensures that concurrent updates only change the existing profile document you expected to change.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">PUT http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
Content-Type: application/json; charset=utf-8
If-Match: "7C0791125FAB08C7EB75CC8044CFDCEA56F506958DEEE763E6608608EE76C9EE"

{
  "key_to_change": "value_after_change",
  "key_to_add": "value_to_add"
}
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">NO CONTENT</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
</code></pre></div></div>

<h3 id="get-overwritten-profile">GET Overwritten Profile</h3>
<p>To GET the overwritten profile, the request should be something like the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"BBB79685FA17A8450E7307710C8A79FD9C1059A0106E9F9811AF6FD18D0F0EED"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:17:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"key_to_change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_after_change"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"key_to_add"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_to_add"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="post-activitiesprofile">POST /activities/profile</h2>
<p>This route allows you to create a single profile document if it doesn’t exist or merge an existing profile document if it does exist. The route allows the same URL parameters as the <a href="#put-activitiesprofile">PUT /activities/profile route</a>. The profile document is merged when the profile document exists, the existing profile document is a JSON encoded object, and the posted profile document is a JSON encoded object. When the two JSON encoded documents are merged, only the top-level properties are merged. The example requests below demonstrate merging profile documents. For more information, view the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Communication.md#27-activity-profile-resource">POST /activities/profile route in the xAPI specification</a>.</p>

<h3 id="post-initial-profile">POST Initial Profile</h3>
<p>To POST an initial profile, the request should be something like the request below. Notice that there is an <code class="language-plaintext highlighter-rouge">If-None-Match</code> header in the request below, this is to ensure that a profile document doesn’t already exist before the profile document is created. Without the <code class="language-plaintext highlighter-rouge">If-None-Match</code> header there would be a precondition failure thrown and the response would be a 412 for the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">POST http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
Content-Type: application/json; charset=utf-8
If-None-Match: "*"

{
  "key_to_keep": "value_to_keep",
  "key_to_change": "value_before_change"
}
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">NO CONTENT</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
</code></pre></div></div>

<h3 id="get-initial-post-activity-etag">GET Initial POST Activity ETag</h3>
<p>To retrieve the ETag for the initial profile, you need to retrieve the profile via the <a href="#get-activitiesprofile">GET /activities/profile route</a>. The request below demonstrates how to do this.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below. Notice that it contains the <code class="language-plaintext highlighter-rouge">ETag</code> header.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"7C0791125FAB08C7EB75CC8044CFDCEA56F506958DEEE763E6608608EE76C9EE"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:16:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"key_to_keep"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_to_keep"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"key_to_change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_before_change"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="post-merge-profile">POST Merge Profile</h3>
<p>To POST a profile for merging, the request should be something like the request below. Notice that the <a href="#get-initial-post-activity-etag">ETag from the previous request</a> has been used in the <code class="language-plaintext highlighter-rouge">If-Match</code> header below. Without the <code class="language-plaintext highlighter-rouge">If-Match</code> header containing the correct ETag there would be a precondition failure thrown and the response would be a 412 for the request below. The <code class="language-plaintext highlighter-rouge">If-Match</code> header ensures that concurrent updates only change the existing profile document you expected to change.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">POST http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
Content-Type: application/json; charset=utf-8
If-Match: "7C0791125FAB08C7EB75CC8044CFDCEA56F506958DEEE763E6608608EE76C9EE"

{
  "key_to_change": "value_after_change",
  "key_to_add": "value_to_add"
}
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">NO CONTENT</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
</code></pre></div></div>

<h3 id="get-merged-profile">GET Merged Profile</h3>
<p>To GET the merged profile, the request should be something like the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"BBB79685FA17A8450E7307710C8A79FD9C1059A0106E9F9811AF6FD18D0F0EED"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:17:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"key_to_keep"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_to_keep"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"key_to_change"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_after_change"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"key_to_add"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_to_add"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="get-activitiesprofile">GET /activities/profile</h2>
<p>This route allows you to retrieve a single profile document or multiple profile identifiers. If the <code class="language-plaintext highlighter-rouge">profileId</code> URL parameter is set, it will <a href="#retrieve-single-activity-document">retrieve a single profile document</a> with the profile identifier, otherwise it will <a href="#retrieve-many-activity-identifiers">retrieve many profile identifiers</a>. For more information, view the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Communication.md#27-activity-profile-resource">GET /activities/profile route in the xAPI specification</a>.</p>

<h3 id="retrieve-single-activity-document">Retrieve Single Activity Document</h3>
<p>The route allows the same URL parameters as the <a href="#put-activitiesprofile">PUT /activities/profile route</a>. A request to this route should be similar to the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below. If the profile document cannot be found, a 404 response will be returned instead of a 200.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"7C0791125FAB08C7EB75CC8044CFDCEA56F506958DEEE763E6608608EE76C9EE"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:16:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"example_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="retrieve-many-activity-identifiers">Retrieve Many Activity Identifiers</h3>
<p>The route allows the same URL parameters as the <a href="#put-activitiesprofile">PUT /activities/profile route</a> except for the <code class="language-plaintext highlighter-rouge">profileId</code> parameter and with the addition of the optional <code class="language-plaintext highlighter-rouge">since</code> parameter. The <code class="language-plaintext highlighter-rouge">since</code> URL parameter is an ISO timestamp that ensures only profile identifiers stored since the timestamp (exclusive) are returned. A request to this route should be similar to the request below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;since=2017-09-04T12:45:31+00:00
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below, where the JSON encoded response body contains an array of profile identifiers that match the URL parameters.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>

<span class="p">[</span><span class="s2">"example_profile_id"</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h2 id="delete-activitiesprofile">DELETE /activities/profile</h2>
<p>This route allows you to delete a single profile document and allows the same URL parameters as the <a href="#put-activitiesprofile">PUT /activities/profile route</a>. For more information, view the <a href="https://github.com/adlnet/xAPI-Spec/blob/master/xAPI-Communication.md#27-activity-profile-resource">DELETE /activities/profile route in the xAPI specification</a>.</p>

<h3 id="get-activity-profile-etag">GET Activity Profile ETag</h3>
<p>To retrieve the ETag for the activity profile, you need to retrieve the profile via the <a href="#get-activitiesprofile">GET /activities/profile route</a>. The request below demonstrates how to do this.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">GET http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">ETag</span><span class="p">:</span> <span class="s">"BBB79685FA17A8450E7307710C8A79FD9C1059A0106E9F9811AF6FD18D0F0EED"</span>
<span class="na">Last-Modified</span><span class="p">:</span> <span class="s">2017-08-31T15:17:29.709Z</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"example_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_value"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="delete-activity-profile">Delete Activity Profile</h3>
<p>Notice that the <a href="#get-activity-profile-etag">ETag from the previous request</a> has been used in the <code class="language-plaintext highlighter-rouge">If-Match</code> header below. Without the <code class="language-plaintext highlighter-rouge">If-Match</code> header containing the correct ETag there would be a precondition failure thrown and the response would be a 412 for the request below. The <code class="language-plaintext highlighter-rouge">If-Match</code> header ensures that concurrent deletes only delete the existing profile document you expected to delete.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">DELETE http://www.example.org/data/xAPI/activities/profile?activityId=http%3A%2F%2Fwww.example.org%2Factivity&amp;profileId=example_profile_id
Authorization: YOUR_BASIC_AUTH
X-Experience-API-Version: 1.0.3
If-Match: "BBB79685FA17A8450E7307710C8A79FD9C1059A0106E9F9811AF6FD18D0F0EED"
</span></code></pre></div></div>

<p>The response to the request above would be something similar to the response below. If the profile document cannot be found, a 404 response will be returned instead of a 204.</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">NO CONTENT</span>
<span class="na">X-Experience-API-Version</span><span class="p">:</span> <span class="s">1.0.3</span>
</code></pre></div></div>

      </div>
    </div>
  </div>

  <footer class="docs-footer">
  <p>Learning Locker and the Squirrel logo are trademark of Learning Pool
    <script>document.write(new Date().getFullYear())</script> | Learning Locker is licensed under GPL 3.0.</p>
  <p>
    <a href="#">Back to top</a>
  </p>
</footer>


</body>

</html>