<!DOCTYPE html>
<html>

<head>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-941797-10"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments)};
      gtag('js', new Date());

      gtag('config', 'UA-941797-10');
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Learning Locker Documentation</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Documentation for Learning Locker, the open source learning record store.">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/tomorrow-night.css">
    <link rel="stylesheet" href="../css/docs.css">

    <script type="text/javascript">
        function prettyCode() {
            var tables = document.getElementsByTagName('table');
            for (index = 0; index < tables.length; ++index) {
                tables[index].className = "table table-default table-bordered";
            }
        }
    </script>
</head>


<body onload="prettyCode();">

  <div class="docs-masthead">
    <div class="container">
      <a href="../welcome"><img src="../images/logo-small.png" class="logo"></a>
        <nav class="docs-nav pull-right">
            <a class="docs-nav-item" href="http://learninglocker.net">Main Website</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/learninglocker">Github</a>
            <a class="docs-nav-item" href="https://github.com/LearningLocker/docs">Edit</a>
        </nav>
    </div>
</div>


  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-3 docs-sidebar">
        <div class="sidebar-title">
          <a href="../welcome">Overview</a>
        </div>
        <ul class="nav">
          <li><a href="../overview-architecture">Architecture</a></li>
          <li><a href="../overview-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="#">Guides</a>
        </div>
        <ul class="nav">
          <li><a href="../guides-installing">Installation</a></li>
          <li><a href="../guides-custom-installation">Custom Installations</a></li>
          <li><a href="../guides-configuring">Configuration</a></li>
          <li><a href="../guides-cli">CLI Operations</a></li>
          <li><a href="../guides-migrating">Migrating from v1</a></li>
          <li><a href="../guides-indexing">Indexing</a></li>
          <li><a href="../guides-monitoring">Monitoring</a></li>
          <li><a href="../guides-structuring">Structuring your LRS</a></li>
          <li><a href="../guides-inserting">Inserting statements</a></li>
          <li><a href="../guides-retrieving">Retrieving statements</a></li>
          <li><a href="../guides-integrating">Integrations</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">HTTP Interfaces (APIs)</a>
        </div>
        <ul class="nav">
          <li><a href="../http-rest">REST API</a></li>
          <li><a href="../http-connection">Connection API</a></li>
          <li><a href="../http-aggregation">Aggregation API</a></li>
          <li><a href="../http-aggregate"><strong>[Enterprise]</strong> Aggregate API</a></li>
          <li><a href="../http-statement-deletion">Statement Deletion API</a></li>
        </ul>

        <div class="sidebar-title">
          <a href="#">Models</a>
        </div>
        <ul class="nav">
          <li><a href="../http-activities"><strong>[Enterprise]</strong> Activities</a></li>
          <li><a href="../http-clients">Clients</a></li>
          <li><a href="../http-dashboards">Dashboards</a></li>
          <li><a href="../http-downloads">Downloads</a></li>
          <li><a href="../http-exports">Exports</a></li>
          <li><a href="../http-journeys"><strong>[Enterprise]</strong> Journeys</a></li>
          <li><a href="../http-journey-progress"><strong>[Enterprise]</strong> Journey Progress</a></li>
          <li><a href="../http-organisations">Organisations</a></li>
          <li><a href="../http-personas">Personas</a></li>
          <li><a href="../http-persona-identifiers">Persona Identifiers</a></li>
          <li><a href="../http-persona-attributes">Persona Attributes</a></li>
          <li><a href="../http-persona-imports">Persona Imports</a></li>
          <li><a href="../http-queries">Queries</a></li>

          <li><a href="../http-roles">Roles</a></li>
          <li><a href="../http-statements">Statements</a></li>
          <li><a href="../http-statement-forwarding">Statement Forwarding</a></li>
          <li><a href="../http-stores">Stores</a></li>
          <li><a href="../http-users">Users</a></li>
          <li><a href="../http-visualisations">Visualisations</a></li>
          <li><a href="../http-xapi">xAPI</a></li>
        </ul>
        <div class="sidebar-title">
          <a href="../faqs">FAQs</a>
        </div>
      </div>
      <div class="col-xs-12 col-sm-9 docs-main">
        <h1 id="installing">Installing</h1>

<h2 id="community-ami-on-amazon-web-services-aws">Community AMI on Amazon Web Services (AWS)</h2>

<p>By far and away the quickest way to get started with Learning Locker is to install our Community AMI (Amazon Machine Image) on AWS. You will be able to spin up your LRS in a matter of minutes.</p>

<p>To find the AMI, search for “Learning Locker” in the Community AMI’s section when starting a new EC2 instance and follow the instructions below, or watch the video below. Note that we don’t currently support “t2.micro” instances because they don’t provide enough RAM, we recommend “t2.medium” as a minimum.</p>

<iframe width="80%" height="315" src="https://www.youtube.com/embed/7g6PJENusfo" frameborder="0" gesture="media" allowfullscreen="" style="padding-left: 15%;"></iframe>

<h4 id="instructions">Instructions</h4>

<p>When you start the AMI, you will need to allow access to port 80 to your server in order to be able to access your Learning Locker user interface.</p>

<p>You will also need to <em>ssh</em> to the AMI using the default ‘ubuntu’ user and the keypair you specified at launch time, in order to read the <code class="language-plaintext highlighter-rouge">/home/ubuntu/ll_credentials.txt</code> file which contains autogenerated default login credentials for an organisation and user.</p>

<p>This file will be generated when the server is fully running and can take up to 5 minutes to be available.</p>

<p><strong>Please note that by default your EC2 instance will hold all of your LRS’s data. Spinning up a new AMI will not transfer any of your data. Please see the <a href="#upgrading">Upgrading</a> section below if you plan on using your LRS for real users and keeping your LRS up to date.</strong></p>

<h2 id="via-the-install-script">Via the install script</h2>

<p>To install Learning Locker, you can run one of the commands below <strong>as the root user</strong> on <code class="language-plaintext highlighter-rouge">Ubuntu</code>. For more information, you can view the <a href="https://github.com/LearningLocker/deploy">deployment repository’s documentation</a>. Alternatively, view the following video tutorial:</p>

<iframe width="80%" height="315" src="https://www.youtube.com/embed/tc_VDNjXLSc" frameborder="0" gesture="media" allowfullscreen="" style="padding-left: 15%;"></iframe>

<p><strong>You must run this script as root user. Typically this can be done by running <code class="language-plaintext highlighter-rouge">sudo su -</code></strong></p>

<p><strong>Install with cURL</strong></p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-o-</span> <span class="nt">-L</span> https://raw.githubusercontent.com/LearningLocker/deploy/master/deployll.sh <span class="o">&gt;</span> deployll.sh <span class="o">&amp;&amp;</span> bash deployll.sh
</code></pre></div></div>
<p><strong>Install with Wget</strong>:</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="nt">-qO</span> deployll.sh https://raw.githubusercontent.com/LearningLocker/deploy/master/deployll.sh <span class="o">&amp;&amp;</span> bash deployll.sh
</code></pre></div></div>

<h3 id="upgrading">Upgrading</h3>

<p>You may choose to upgrade your Learning Locker to take advantage of new features and bug fixes. To make this process easier, it is strongly recommended that any Learning Locker running for production use has the database (Mongo) running on different servers to that of the application. This means you can seamlessly update your application without having to move your data.</p>

<p>You can run the install script below on your existing EC2 server and that will grab and rebuild the code directly on the server. <strong>Please note: this requires an EC2 instance with at least 2GB of RAM</strong>. You will be asked if you wish to “upgrade” any existing instance, or perform a fresh install.</p>

<p>If you are using an AMI, this will come with Mongo and Redis installed - by default your data will live on the same server as your application.</p>

<p>Over time this will allow you to simply spin up newer versions of the AMI and simply adjust your configuration file to point at your Mongo and Redis instances (existing on other servers). You will also be able to utilise load balancers to handle more traffic and provide redundancy for your site.</p>

<p>If you plan on keeping the Mongo database on the same server as the application, you will need to perform a <a href="https://docs.mongodb.com/manual/tutorial/backup-and-restore-tools/">backup and restoration</a> of your Mongo data between upgrades. For this reason we strongly recommend placing your database separate to your application.</p>

<h3 id="logs">Logs</h3>

<p>By default, logs are written to <code class="language-plaintext highlighter-rouge">/var/log/learninglocker/</code></p>

<h4 id="install-log">Install log</h4>

<p>If there is a problem installing the script, you can view the full install log output here:
<code class="language-plaintext highlighter-rouge">/var/log/learninglocker/install.log</code></p>

<h4 id="service-logs">Service logs</h4>

<p>Individual logs for the different services outputs (stdout) and errors (stderr) are available in this directory under the following names:</p>

<p><strong>stdout</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">xapi_stdout***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">api_stdout***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">ui_stdout***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">worker_stdout***.log</code></li>
</ul>

<p><strong>stderr</strong></p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">xapi_stderr***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">api_stderr***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">ui_stderr***.log</code></li>
  <li><code class="language-plaintext highlighter-rouge">worker_stderr***.log</code></li>
</ul>

<p><code class="language-plaintext highlighter-rouge">***</code>: <em>Logs may have slightly different names due to rotation</em></p>

<h3 id="restarting-the-services">Restarting the services</h3>
<p>To restart the services, simply run the following command:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service pm2-learninglocker restart
</code></pre></div></div>
<p>Where <code class="language-plaintext highlighter-rouge">learninglocker</code> is the system user you chose to install with in the script (defaults to <code class="language-plaintext highlighter-rouge">learninglocker</code>)</p>

<h3 id="managing-the-services">Managing the services</h3>

<p>The PM2 service manages the 4 micro-services that Learning Locker requires. This is installed by default with the install script under the system user you chose.</p>

<p><strong>In order to use the pm2 service, first ensure you are in as the correct system user:</strong></p>

<p>(using the default <code class="language-plaintext highlighter-rouge">learninglocker</code> system user):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo su learninglocker
</code></pre></div></div>

<h4 id="service-status">Service status</h4>
<p>To view the status of your processes (using the default <code class="language-plaintext highlighter-rouge">learninglocker</code> system user):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 status
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌──────────┬─────────┬────────┬───┬──────┬────────────┐
│ Name     │ mode    │ status │ ↺ │ cpu  │ memory     │
├──────────┼─────────┼────────┼───┼──────┼────────────┤
│ API      │ cluster │ online │ 0 │ 0%   │ 144.0 MB   │
│ UIServer │ cluster │ online │ 0 │ 0%   │ 105.8 MB   │
│ Worker   │ cluster │ online │ 0 │ 0%   │ 109.5 MB   │
│ xAPI     │ cluster │ online │ 0 │ 0%   │ 81.8 MB    │
└──────────┴─────────┴──-─────┴───┴──────┴────────────┘
</code></pre></div></div>

<h4 id="service-logs-1">Service logs</h4>

<p>You can view a tail of the logs by running:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 logs
</code></pre></div></div>

<p>Or view the logs for a particular service (by name or ID):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 logs xAPI
</code></pre></div></div>

<p>To view more lines:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 logs --lines 1000
</code></pre></div></div>

<h3 id="restarting-the-services-manually">Restarting the services manually</h3>
<p>You can restart all the services by running:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 restart all
</code></pre></div></div>

<p>Or individual services by their name or ID:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pm2 restart UIServer
</code></pre></div></div>

<h3 id="application-structure">Application Structure</h3>

<p>There are two main repositories that are installed as part of a fresh Learning Locker installation, the <a href="https://github.com/LearningLocker/learninglocker">Learning Locker application</a> and <a href="https://github.com/LearningLocker/xapi-service">xAPI service</a>. An in depth look at what both these packages do can be read in the <a href="../overview-architecture">Architecture Overview</a>.</p>

<p>When installing your LL instance using the install script, these packages will be (by default) installed to <code class="language-plaintext highlighter-rouge">/usr/local/learninglocker/current</code> (as a symlink to a directory inside <code class="language-plaintext highlighter-rouge">/usr/local/learninglocker/release/...</code>).</p>

<p>Inside <code class="language-plaintext highlighter-rouge">current/webapp/</code> lives the Learning Locker application which controls the User Interface, API and worker.</p>

<p>We also install the xAPI Service here, inside the <code class="language-plaintext highlighter-rouge">current/xapi/</code> directory.</p>

<h3 id="configuration--environment-variables">Configuration &amp; Environment Variables</h3>

<p>Each of these applications has their own <code class="language-plaintext highlighter-rouge">.env</code>. These hold all the configurations that the applications require in order to run, from database settings to logging configuration.</p>

<p>By default the install script will copy the (.env.example) from <a href="https://github.com/LearningLocker/learninglocker/blob/master/.env.example">both</a> repos <a href="https://github.com/LearningLocker/xapi-service/blob/master/.env.example">respectively</a>.</p>

<p>It is likely you will wish to configure your application to connect to external databases, and whilst setup and configuration of these is beyond the scopes of this documentation, you will need to ensure that both <code class="language-plaintext highlighter-rouge">.env</code> files contain the same configuration values where appropriate.</p>

<p>A full description of all configuration values in both repositories is available in the <a href="../guides-configuring">Configuration Guide</a></p>

<hr />

<h2 id="production-installations">Production Installations</h2>
<p>For production installations, we recommend the following setup<strong>:</strong></p>

<ul>
  <li>1 Load balancer (e.g. <a href="https://aws.amazon.com/elasticloadbalancing/">AWS Elastic Load Balancing</a>);</li>
  <li>2 Learning Locker servers (e.g. <a href="https://aws.amazon.com/ec2/">AWS EC2</a>);</li>
  <li>3 Mongo servers in a replica set (e.g. <a href="https://www.mongodb.com/cloud/atlas">Atlas</a>);</li>
  <li>1 Redis server (e.g. <a href="https://aws.amazon.com/elasticache/">AWS ElastiCache</a>).</li>
</ul>

<p>This setup ensures good performance and a reasonable degree of redundancy in case of failures in some parts. We’d also recommend that you back up your Mongo database quite regularly depending on your own data requirements. If this sounds too costly or challenging, you may wish to consider using <a href="https://learningpool.com/solutions/learning-record-store-learning-locker/">our Software as a Service (SaaS) enterprise solution</a>. If you require more advice for your setup, please get in touch via <a href="mailto:hello@learninglocker.net">hello@learninglocker.net</a>.</p>

<hr />

<h2 id="custom-installations">Custom installations</h2>

<p>Please follow instructions <a href="../guides-custom-installation">here</a> if you wish to install Learning Locker manually.</p>

      </div>
    </div>
  </div>

  <footer class="docs-footer">
  <p>Learning Locker and the Squirrel logo are trademark of Learning Pool
    <script>document.write(new Date().getFullYear())</script> | Learning Locker is licensed under GPL 3.0.</p>
  <p>
    <a href="#">Back to top</a>
  </p>
</footer>


</body>

</html>